#define _CRT_SECURE_NO_WARNINGS
#include <iostream>
#include <vector>
#include <algorithm>
using namespace std;

const int MAXN = 50;
const int MAXP = 30;
const int INF = 1e9;
const pair<int, int> OUTOFGRID = { -1,-1};

int N, M, P, C, D;

int rudolf_x, rudolf_y;
pair<int, int> santa[MAXP + 10];
int stunned[MAXP + 10];
int score[MAXP + 10];

int print_grid[MAXN + 10][MAXN + 10];

int dx[8] = { -1,-1,0,1,1,1,0,-1 };
int dy[8] = { 0,1,1,1,0,-1,-1,-1 };

void print() {
	for (int i = 0; i < N; i++) {
    		for (int j = 0; j < N; j++) {
            			print_grid[i][j] = 0;
                        		}
                                	}

                                    	cout << "pos" << "\n";
                                        	print_grid[rudolf_x][rudolf_y] = -1;
                                            	for (int i = 1; i <= P; i++) {
                                                		print_grid[santa[i].first][santa[i].second] = i;
                                                        	}
                                                            	for (int i = 0; i < N; i++) {
                                                                		for (int j = 0; j < N; j++) {
                                                                        			cout << print_grid[i][j] << " ";
                                                                                    		}
                                                                                            		cout << "\n";
                                                                                                    	}
                                                                                                        	cout << "\n";

                                                                                                            	cout << "stunned" << "\n";
                                                                                                                	for (int i = 1; i <= P; i++) {
                                                                                                                    		cout << i << " : " << stunned[i] << "\n";
                                                                                                                            	}
                                                                                                                                	cout << "\n";

                                                                                                                                    	cout << "score" << "\n";
                                                                                                                                        	for (int i = 1; i <= P; i++) {
                                                                                                                                            		cout << i << " : " << score[i] << "\n";
                                                                                                                                                    	}
                                                                                                                                                        	cout << "\n";
                                                                                                                                                            }

                                                                                                                                                            bool isOver() {
                                                                                                                                                            	for (int i = 1; i <= P; i++) {
                                                                                                                                                                		if (santa[i] != OUTOFGRID) return false;
                                                                                                                                                                        	}
                                                                                                                                                                            	return true;
                                                                                                                                                                                }

                                                                                                                                                                                struct State {
                                                                                                                                                                                	int id;
                                                                                                                                                                                    	int d;
                                                                                                                                                                                        	int x;
                                                                                                                                                                                            	int y;

                                                                                                                                                                                                	bool operator < (const State& other) const {
                                                                                                                                                                                                    		if (d != other.d) return d > other.d;
                                                                                                                                                                                                            		if (x != other.x) return x < other.x;
                                                                                                                                                                                                                    		return y < other.y;
                                                                                                                                                                                                                            	}
                                                                                                                                                                                                                                };

                                                                                                                                                                                                                                int getDist(int x1, int y1, int x2, int y2) {
                                                                                                                                                                                                                                	return (x1 - x2) * (x1 - x2) + (y1 - y2) * (y1 - y2);
                                                                                                                                                                                                                                    }

                                                                                                                                                                                                                                    bool inRange(int x, int y) {
                                                                                                                                                                                                                                    	return (x >= 0 && x < N && y >= 0 && y < N);
                                                                                                                                                                                                                                        }

                                                                                                                                                                                                                                        void interact(int id, int dir) {
                                                                                                                                                                                                                                        	int target = id;

                                                                                                                                                                                                                                            	while (1) {
                                                                                                                                                                                                                                                		int oppo = -1;

                                                                                                                                                                                                                                                        		for (int i = 1; i <= P; i++) {
                                                                                                                                                                                                                                                                			if (santa[i] == OUTOFGRID) continue;
                                                                                                                                                                                                                                                                            			if (i == target) continue;

                                                                                                                                                                                                                                                                                        			if (santa[target] == santa[i]) {
                                                                                                                                                                                                                                                                                                    				oppo = i;
                                                                                                                                                                                                                                                                                                                    				break;
                                                                                                                                                                                                                                                                                                                                    			}
                                                                                                                                                                                                                                                                                                                                                		}

                                                                                                                                                                                                                                                                                                                                                        		if (oppo == -1) return;

                                                                                                                                                                                                                                                                                                                                                                		santa[oppo].first += dx[dir];
                                                                                                                                                                                                                                                                                                                                                                        		santa[oppo].second += dy[dir];
                                                                                                                                                                                                                                                                                                                                                                                		if (!inRange(santa[oppo].first, santa[oppo].second)) santa[oppo] = OUTOFGRID;

                                                                                                                                                                                                                                                                                                                                                                                        		target = oppo;
                                                                                                                                                                                                                                                                                                                                                                                                	}
                                                                                                                                                                                                                                                                                                                                                                                                    }

                                                                                                                                                                                                                                                                                                                                                                                                    void moveRudolf(int turn) {
                                                                                                                                                                                                                                                                                                                                                                                                    	vector<State> v;
                                                                                                                                                                                                                                                                                                                                                                                                        	for (int i = 1; i <= P; i++) {
                                                                                                                                                                                                                                                                                                                                                                                                            		if (santa[i] == OUTOFGRID) continue;
                                                                                                                                                                                                                                                                                                                                                                                                                    		int cx = santa[i].first;
                                                                                                                                                                                                                                                                                                                                                                                                                            		int cy = santa[i].second;
                                                                                                                                                                                                                                                                                                                                                                                                                                    		v.push_back({ i, getDist(cx, cy, rudolf_x, rudolf_y), cx, cy });
                                                                                                                                                                                                                                                                                                                                                                                                                                            	}
                                                                                                                                                                                                                                                                                                                                                                                                                                                	sort(v.begin(), v.end()); // sort 해줘야 우선순위 반영

                                                                                                                                                                                                                                                                                                                                                                                                                                                    	int sz = (int)v.size();
                                                                                                                                                                                                                                                                                                                                                                                                                                                        	int target = v[sz - 1].id;

                                                                                                                                                                                                                                                                                                                                                                                                                                                            	int min_dist = INF;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                	int min_dir = -1;

                                                                                                                                                                                                                                                                                                                                                                                                                                                                    	for (int dir = 0; dir < 8; dir++) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        		int nx = rudolf_x + dx[dir];
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                		int ny = rudolf_y + dy[dir];

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        		if (!inRange(nx, ny)) continue;

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                		int cur_dist = getDist(nx, ny, santa[target].first, santa[target].second);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        		if (min_dist > cur_dist) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                			min_dist = cur_dist;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            			min_dir = dir;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        		}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                	}

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    	rudolf_x += dx[min_dir];
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        	rudolf_y += dy[min_dir];

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            	if (rudolf_x == santa[target].first && rudolf_y == santa[target].second) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                		score[target] += C;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        		stunned[target] = turn + 2;

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                		for (int cnt = 1; cnt <= C; cnt++) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        			santa[target].first += dx[min_dir];
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    			santa[target].second += dy[min_dir];
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                		}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        		if (!inRange(santa[target].first, santa[target].second)) santa[target] = OUTOFGRID;

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                		interact(target, min_dir);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        	}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            }

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            bool otherSanta(int x, int y) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            	for (int i = 1; i <= P; i++) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                		if (santa[i].first == x && santa[i].second == y) return true;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        	}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            	return false;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                }

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                void moveSanta(int turn) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                	for (int i = 1; i <= P; i++) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    		if (stunned[i] > turn) continue;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            		if (santa[i] == OUTOFGRID) continue;

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    		int cx = santa[i].first;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            		int cy = santa[i].second;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    		int min_dist = INF;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            		int min_dir = -1;

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    		for (int dir = 0; dir < 8; dir += 2) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            			int nx = cx + dx[dir];
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        			int ny = cy + dy[dir];

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    			if (inRange(nx, ny) && !otherSanta(nx, ny) && getDist(cx, cy, rudolf_x, rudolf_y) > getDist(nx, ny, rudolf_x, rudolf_y) && min_dist > getDist(nx, ny, rudolf_x, rudolf_y)) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                				min_dist = getDist(nx, ny, rudolf_x, rudolf_y);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                				min_dir = dir;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                			}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            		}

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    		if (min_dir != -1) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            			santa[i].first += dx[min_dir];
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        			santa[i].second += dy[min_dir];
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    		}

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            		if (rudolf_x == santa[i].first && rudolf_y == santa[i].second) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    			min_dir = (min_dir + 4) % 8;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                			score[i] += D;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            			stunned[i] = turn + 2;

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        			for (int cnt = 1; cnt <= D; cnt++) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    				santa[i].first += dx[min_dir];
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    				santa[i].second += dy[min_dir];
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    			}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                			if (!inRange(santa[i].first, santa[i].second)) santa[i] = OUTOFGRID;

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            			interact(i, min_dir);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        		}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                	}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    }

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    void survivePoint() {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    	for (int i = 1; i <= P; i++) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        		if (santa[i] != OUTOFGRID) score[i]++;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                	}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    }

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    int main() {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    	ios::sync_with_stdio(0); cin.tie(0); cout.tie(0);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        	//freopen("sample_input.txt", "r", stdin);

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            	cin >> N >> M >> P >> C >> D;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                	cin >> rudolf_x >> rudolf_y;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    	rudolf_x--; rudolf_y--;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        	for (int i = 1; i <= P; i++) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            		int id, r, c; cin >> id >> r >> c;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    		r--; c--;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            		santa[id] = { r, c };
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    		stunned[id] = false;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            	}

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                	//print();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    	for (int turn = 1; turn <= M; turn++) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        		//cout << "turn : " << turn << "\n";
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                		
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        		//cout << "moveRudolf" << "\n";
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                		moveRudolf(turn);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        		//print();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                		if (isOver()) break;

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        		//cout << "moveSanta" << "\n";
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                		moveSanta(turn);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        		//print();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                		if (isOver()) break;

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        		survivePoint();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                		//print();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        	}

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            	for (int i = 1; i <= P; i++) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                		cout << score[i] << " ";
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        	}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            	cout << "\n";
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                	return 0;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    }